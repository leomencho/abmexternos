<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<body>
<div th:fragment="default">
  <h2>Sistema de ABM externos</h2>
  <img src="/images/welcome.png" alt="Bienvenida" style="width: 80%; max-width: 800px; border-radius: 10px;">

</div>


<div th:fragment="buscar">
  <div class="container mt-4">
    <h2 class="mb-4">Buscar Registro</h2>
    <form method="get" action="/buscar" class="row g-3">

      <!-- Apellido -->
      <div class="col-md-6">
        <label class="form-label">Apellido</label>
        <input type="text" name="apellido" class="form-control" placeholder="Ingrese Apellido" maxlength="50">
      </div>

      <!-- Nombre -->
      <div class="col-md-6">
        <label class="form-label">Nombre</label>
        <input type="text" name="nombre" class="form-control" placeholder="Ingrese Nombre" maxlength="50">
      </div>

      <!-- Programa -->
      <div class="col-md-6">
        <label class="form-label">Programa</label>
        <select name="programa" class="form-select">
          <option value="" selected disabled>Seleccione Programa</option>
          <option th:each="p : ${programas}" th:value="${p.id}" th:text="${p.nombre}"></option>
        </select>
      </div>

      <!-- Estado -->
      <div class="col-md-6">
        <label class="form-label">Estado</label>
        <select name="estado" class="form-select">
          <option value="" selected disabled>Seleccione Estado</option>
          <option value="activo">Activo</option>
          <option value="desactivado">Desactivado</option>
          <option value="pausado">Pausado</option>
          <option value="pre-aprobado">Pre-Aprobado</option>
        </select>
      </div>

      <!-- Botón de búsqueda -->
      <div class="col-12 mt-3 text-center">
        <button type="submit" class="btn btn-primary btn-lg px-5">Buscar</button>
      </div>

    </form>
  </div>
</div>




<div th:fragment="nuevo">
  <div class="container mt-4">
    <h2 class="mb-4">Nuevo Registro</h2>

    <form method="post" action="/modificar" enctype="multipart/form-data" class="row g-3">

      <!-- Foto con preview y subida al hacer click -->
      <div class="col-12 text-center">
        <label class="form-label d-block">Foto de Perfil</label>
        <label for="fotoInput">
          <img id="fotoPreview" src="/default-avatar.png" alt="Foto" class="img-thumbnail"
               style="width:150px; height:150px; object-fit:cover; cursor:pointer;">
        </label>
        <input type="file" id="fotoInput" name="foto" class="d-none" onchange="previewFoto(this)">
      </div>

      <!-- Nombre -->
      <div class="col-md-6">
        <label class="form-label">Nombre</label>
        <input type="text" name="nombre" maxlength="50" class="form-control" required>
      </div>

      <!-- Apellido -->
      <div class="col-md-6">
        <label class="form-label">Apellido</label>
        <input type="text" name="apellido" maxlength="50" class="form-control" required>
      </div>

      <!-- DNI -->
      <div class="col-md-4">
        <label class="form-label">DNI</label>
        <input type="number" name="dni" maxlength="11" class="form-control" required>
      </div>

      <!-- CUIL -->
      <div class="col-md-4">
        <label class="form-label">CUIL</label>
        <input type="text" name="cuil" pattern="\\d{2}-\\d{8}-\\d" class="form-control" placeholder="XX-XXXXXXXX-X" required>
      </div>

      <!-- Fecha de Nacimiento -->
      <div class="col-md-4">
        <label class="form-label">Fecha de Nacimiento</label>
        <input type="date" name="fecha_nac" class="form-control" required>
      </div>

      <!-- Email -->
      <div class="col-md-6">
        <label class="form-label">Email</label>
        <input type="email" name="mail" maxlength="50" class="form-control" required>
      </div>

      <!-- Programa -->
      <div class="col-md-6">
        <label class="form-label">Programa</label>
        <select name="programa" class="form-select" required>
          <option value="" disabled selected>Seleccione un programa</option>
          <option th:each="p : ${programas}" th:value="${p.id}" th:text="${p.nombre}"></option>
        </select>
      </div>

      <!-- Función -->
      <div class="col-md-6">
        <label class="form-label">Función</label>
        <select name="funcion" class="form-select">
          <option value="" disabled selected>Seleccione una función</option>
          <option th:each="f : ${funciones}" th:value="${f.id}" th:text="${f.nombre}"></option>
        </select>
      </div>

      <!-- Reporta a -->
      <div class="col-md-6">
        <label class="form-label">Reporta a</label>
        <select name="reporta" class="form-select">
          <option value="" disabled selected>Seleccione un responsable</option>
          <option th:each="u : ${usuarios}" th:value="${u.id}" th:text="${u.nombre} + ' ' + ${u.apellido}"></option>
        </select>
      </div>






      <!-- Estado (más chico) -->
      <div class="col-md-3">
        <label class="form-label">Estado</label>
        <select name="estado" class="form-select form-select-sm">
          <option value="activo">Activo</option>
          <option value="desactivado">Desactivado</option>
          <option value="pausado">Pausado</option>
          <option value="pre-aprobado">Pre-Aprobado</option>
        </select>
      </div>

      <!-- Perfil (más chico) -->
      <div class="col-md-3">
        <label class="form-label">Perfil</label>
        <select name="perfil" class="form-select form-select-sm">
          <option value="admin">Admin</option>
          <option value="rrhh">RRHH</option>
          <option value="usuario">Usuario</option>
        </select>
      </div>

      <!-- Contraseña -->
      <div class="col-md-6">
        <label class="form-label">Contraseña</label>
        <input type="password" name="pass" maxlength="50" class="form-control" required>
      </div>

      <!-- Recursos -->
      <div class="col-md-12">
        <label class="form-label">Recursos</label>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" name="recursos" value="Internet" id="recursoInternet">
          <label class="form-check-label" for="recursoInternet">Internet</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" name="recursos" value="Videos" id="recursoVideos">
          <label class="form-check-label" for="recursoVideos">Videos</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" name="recursos" value="Discos" id="recursoDiscos">
          <label class="form-check-label" for="recursoDiscos">Discos</label>
        </div>
        <div class="form-check form-check-inline">
          <input class="form-check-input" type="checkbox" name="recursos" value="Correo" id="recursoCorreo">
          <label class="form-check-label" for="recursoCorreo">Correo</label>
        </div>
      </div>
      <!-- Seguro -->
      <div class="col-12">
        <label class="form-label">Documentación de Seguro</label>
        <div class="row">
          <!-- Listado de archivos -->
          <div class="col-md-4">
            <ul class="list-group">
              <li th:each="archivo : ${archivos}" class="list-group-item">
                <a th:href="@{'/modificar?archivo=' + ${archivo}}" th:text="${archivo}"></a>
              </li>
            </ul>
          </div>

          <!-- Vista previa -->
          <div class="col-md-8">
            <div th:if="${archivoSeleccionado}" class="border rounded p-2">
              <embed th:src="@{'/seguros/' + ${usuarioId} + '/' + ${archivoSeleccionado}}"
                     type="application/pdf" width="100%" height="300px"/>
            </div>
            <div th:if="${archivoSeleccionado == null}">
              <p class="text-muted">Seleccione un archivo para previsualizarlo aquí.</p>
            </div>
          </div>
        </div>
      </div>

      <div class="col-12 mt-3">
        <button type="submit" class="btn btn-primary">Guardar</button>
      </div>
    </form>
  </div>



  <script>
    function previewFoto(input) {
      if (input.files && input.files[0]) {
        const reader = new FileReader();
        reader.onload = function(e) {
          document.getElementById('fotoPreview').src = e.target.result;
        }
        reader.readAsDataURL(input.files[0]);
      }
    }
  </script>
</div>




<div th:fragment="modificar">
  <div class="container mt-4">
    <h2 class="mb-4">Modificar Registro</h2>
    <form method="post" action="/modificar" enctype="multipart/form-data" class="row g-3">

      <div class="col-md-6">
        <label class="form-label">Nombre</label>
        <input type="text" name="nombre" class="form-control" required>
      </div>

      <div class="col-md-6">
        <label class="form-label">Apellido</label>
        <input type="text" name="apellido" class="form-control" required>
      </div>

      <div class="col-md-6">
        <label class="form-label">DNI</label>
        <input type="text" name="dni" class="form-control" required>
      </div>

      <div class="col-md-6">
        <label class="form-label">CUIL</label>
        <input type="text" name="cuil" class="form-control" required>
      </div>

      <div class="col-md-6">
        <label class="form-label">Fecha de Nacimiento</label>
        <input type="date" name="fecha_nac" class="form-control" required>
      </div>

      <div class="col-md-6">
        <label class="form-label">Email</label>
        <input type="email" name="mail" class="form-control" required>
      </div>

      <div class="col-md-6">
        <label class="form-label">Programa</label>
        <input type="text" name="programa" class="form-control">
      </div>

      <div class="col-md-6">
        <label class="form-label">Función</label>
        <input type="text" name="funcion" class="form-control">
      </div>

      <div class="col-md-6">
        <label class="form-label">Reporta a</label>
        <input type="text" name="reporta" class="form-control">
      </div>

      <div class="col-md-6">
        <label class="form-label">Foto</label>
        <input type="file" name="foto" class="form-control">
      </div>

      <div class="col-md-6">
        <label class="form-label">Seguro</label>
        <input type="text" name="seguro" class="form-control">
      </div>

      <div class="col-md-6">
        <label class="form-label">Recursos</label>
        <input type="text" name="recursos" class="form-control">
      </div>

      <div class="col-md-6">
        <label class="form-label">Estado</label>
        <input type="text" name="estado" class="form-control">
      </div>

      <div class="col-md-6">
        <label class="form-label">Perfil</label>
        <input type="text" name="perfil" class="form-control">
      </div>

      <div class="col-md-6">
        <label class="form-label">Contraseña</label>
        <input type="password" name="pass" class="form-control" required>
      </div>

      <div class="col-12 mt-3">
        <button type="submit" class="btn btn-primary">Guardar</button>
      </div>

    </form>
  </div>
</div>

</body>
</html>
