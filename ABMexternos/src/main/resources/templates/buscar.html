<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout}">
<head>
    <title>Buscar Registro</title>
</head>

<body>
<section layout:fragment="content">
    <div class="container mt-4">
        <h2 class="mb-4">Buscar Usuario</h2>

        <form method="get" action="/buscar" class="row g-3">
            <!-- Apellido -->
            <div class="col-md-4">
                <label class="form-label">Apellido</label>
                <input type="text" name="apellido" class="form-control" placeholder="Ingrese Apellido" maxlength="50">
            </div>

            <!-- Nombre -->
            <div class="col-md-4">
                <label class="form-label">Nombre</label>
                <input type="text" name="nombre" class="form-control" placeholder="Ingrese Nombre" maxlength="50">
            </div>

            <!-- DNI -->
            <div class="col-md-4">
                <label class="form-label">DNI</label>
                <input type="text" name="dni" class="form-control" placeholder="Ingrese DNI" maxlength="11">
            </div>

            <!-- Bot√≥n de b√∫squeda -->
            <div class="col-12 mt-3 text-center">
                <button type="submit" class="btn btn-primary px-5">Buscar</button>
            </div>
        </form>
    </div>

    <div class="container mt-5">
        <h4>Resultados</h4>
        <div class="table-responsive">
            <table class="table table-striped align-middle">
                <thead class="table-light">
                <tr>
                    <th>Nombre</th>
                    <th>Apellido</th>
                    <th>DNI</th>
                    <th>CUIL</th>
                    <th>Fecha Nac.</th>
                    <th>Tel√©fono</th>
                    <th>Email</th>
                    <th>Comentario</th>
                    <th>Estado</th>
                    <th>Recursos</th>
                    <th>Reporta</th>
                    <th>Programas</th>
                    <th class="text-center">Acciones</th>
                </tr>
                </thead>
                <tbody>
                <tr th:each="u : ${usuarios}">
                    <td th:text="${u.nombre}"></td>
                    <td th:text="${u.apellido}"></td>
                    <td th:text="${u.dni}"></td>
                    <td th:text="${u.cuil}"></td>
                    <td th:text="${#temporals.format(u.fechaNacimiento, 'dd/MM/yyyy')}"></td>
                    <td th:text="${u.telefono}"></td>
                    <td th:text="${u.mail}"></td>
                    <td th:text="${u.comentario}"></td>
                    <td th:text="${u.estado != null ? u.estado.tipoestado : '‚Äî'}"></td>

                    <!-- Recursos -->
                    <td>
                        <span th:each="r : ${u.recursos}"
                              th:text="${r.nombre}"
                              class="badge bg-info text-dark me-1 mb-1"></span>
                    </td>

                    <!-- Reporta -->
                    <td>
                        <span th:each="rep : ${u.reporta}"
                              th:text="${rep.nombre + ' ' + rep.apellido}"
                              class="badge bg-warning text-dark me-1 mb-1"></span>
                    </td>

                    <!-- Programas -->
                    <td>
                        <span th:each="p : ${u.programas}"
                              th:text="${p.nombreCorto}"
                              class="badge bg-secondary me-1 mb-1"></span>
                    </td>

                    <td class="text-center">
                        <a th:href="@{/usuarios/editar/{id}(id=${u.idUsuarios})}" class="btn btn-sm btn-warning me-1 rounded-circle" title="Editar">‚úèÔ∏è</a>
                        <a th:href="@{/usuarios/eliminar/{id}(id=${u.idUsuarios})}" class="btn btn-sm btn-danger rounded-circle" title="Eliminar"
                           onclick="return confirm('¬øEliminar este usuario?')">üóëÔ∏è</a>
                    </td>
                </tr>
                </tbody>
            </table>
        </div>
    </div>

    <!-- Footer -->
    <div th:replace="fragments/footer :: footer"></div>
</section>
</body>
</html>
